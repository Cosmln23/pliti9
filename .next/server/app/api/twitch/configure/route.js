(()=>{var t={};t.id=3141,t.ids=[3141],t.modules={30517:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:t=>{"use strict";t.exports=require("buffer")},6113:t=>{"use strict";t.exports=require("crypto")},82361:t=>{"use strict";t.exports=require("events")},13685:t=>{"use strict";t.exports=require("http")},95687:t=>{"use strict";t.exports=require("https")},41808:t=>{"use strict";t.exports=require("net")},12781:t=>{"use strict";t.exports=require("stream")},24404:t=>{"use strict";t.exports=require("tls")},57310:t=>{"use strict";t.exports=require("url")},59796:t=>{"use strict";t.exports=require("zlib")},58359:()=>{},93739:()=>{},18827:(t,e,o)=>{"use strict";o.r(e),o.d(e,{headerHooks:()=>p,originalPathname:()=>T,patchFetch:()=>C,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>w});var n={};o.r(n),o.d(n,{GET:()=>h,POST:()=>a});var s=o(95419),i=o(69108),r=o(99678),c=o(78070),u=o(98239);async function a(t){try{let{botUsername:e,oauth:o,channel:n}=await t.json();if(!e||!o||!n)return c.Z.json({error:"Missing required fields: botUsername, oauth, channel"},{status:400});if(!u.X.configure(e,o,n))return c.Z.json({error:"Invalid OAuth token"},{status:400});let s=await u.X.connect(),i=u.X.getStatus();return c.Z.json({success:!0,connected:s,status:i,message:s?"Bot configured and connected!":"Bot configured but connection failed"})}catch(t){return console.error("Twitch bot configuration error:",t),c.Z.json({error:"Failed to configure Twitch bot"},{status:500})}}async function h(){try{let t=u.X.getStatus();return c.Z.json({success:!0,status:t})}catch(t){return console.error("Failed to get Twitch bot status:",t),c.Z.json({error:"Failed to get status"},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/twitch/configure/route",pathname:"/api/twitch/configure",filename:"route",bundlePath:"app/api/twitch/configure/route"},resolvedPagePath:"C:\\Users\\user\\Desktop\\plipli paranormal\\app\\api\\twitch\\configure\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:g,serverHooks:f,headerHooks:p,staticGenerationBailout:w}=l,T="/api/twitch/configure/route";function C(){return(0,r.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},98239:(t,e,o)=>{"use strict";o.d(e,{X:()=>i});var n=o(15703);class s{configure(t,e,o){return this.config={botUsername:t||process.env.TWITCH_BOT_USERNAME||"plipli9_bot",oauth:e||process.env.TWITCH_OAUTH_TOKEN||"",channel:o||process.env.TWITCH_CHANNEL||"plipli9"},console.log(`ðŸŽ® Server bot configured for: #${this.config.channel}`),!!this.config.oauth}autoConfigureForProduction(){return this.config?.oauth?console.log("\uD83C\uDFAE Bot already configured"):(this.config={botUsername:"plipli9_bot",oauth:"oauth:ofmzemzx56e09fxzxanwaarmlpchj3",channel:"plipli9"},console.log(`ðŸŽ® AUTO-CONFIGURED for production: #${this.config.channel}`)),!0}async connect(){if(this.config?.oauth||this.autoConfigureForProduction(),!this.config?.oauth)return console.log("âŒ Twitch bot not configured or missing OAuth token"),!1;if(this.isConnected)return console.log("âœ… Already connected to Twitch IRC"),!0;try{return console.log("\uD83C\uDFAE Connecting to Twitch IRC from server..."),this.ws=new n.ZP("wss://irc-ws.chat.twitch.tv:443"),this.ws.on("open",()=>{console.log("\uD83D\uDD0C Server WebSocket connected to Twitch IRC"),this.authenticate()}),this.ws.on("message",t=>{this.handleMessage(t.toString())}),this.ws.on("close",()=>{console.log("\uD83D\uDD0C Disconnected from Twitch IRC"),this.isConnected=!1,this.scheduleReconnect()}),this.ws.on("error",t=>{console.error("âŒ Twitch IRC WebSocket error:",t),this.isConnected=!1}),!0}catch(t){return console.error("âŒ Failed to connect to Twitch IRC:",t),!1}}authenticate(){this.ws&&this.config&&(this.ws.send(`PASS ${this.config.oauth}`),this.ws.send(`NICK ${this.config.botUsername}`),this.ws.send(`JOIN #${this.config.channel}`),this.heartbeatInterval=setInterval(()=>{this.ws?.readyState===n.ZP.OPEN&&this.ws.send("PING :tmi.twitch.tv")},3e4))}handleMessage(t){for(let e of t.trim().split("\n"))console.log("\uD83D\uDCE5 Twitch IRC:",e),e.includes("001")?(this.isConnected=!0,console.log("âœ… Successfully authenticated with Twitch IRC"),console.log(`ðŸŽ¯ Server bot active in channel: #${this.config?.channel}`)):e.startsWith("PING")?this.ws?.send("PONG :tmi.twitch.tv"):e.includes("NOTICE")&&e.includes("Login authentication failed")&&console.error("âŒ Twitch authentication failed - check OAuth token")}async sendMessage(t,e){if(!this.isConnected||!this.ws||!this.config)return console.log("\uD83D\uDD04 Twitch not connected, message dropped:",`${t}: ${e}`),!1;try{let o=`${t.toUpperCase()}: ${e}`;return this.ws.send(`PRIVMSG #${this.config.channel} :${o}`),console.log(`ðŸŽ® âœ… Sent to Twitch #${this.config.channel}: ${o}`),!0}catch(t){return console.error("âŒ Failed to send to Twitch:",t),!1}}scheduleReconnect(){this.reconnectTimeout||(console.log("\uD83D\uDD04 Scheduling Twitch IRC reconnection in 5 seconds..."),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,this.connect()},5e3))}getStatus(){return{connected:this.isConnected,configured:!!this.config?.oauth,channel:this.config?.channel||null,botUsername:this.config?.botUsername||null}}disconnect(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.ws&&(this.ws.close(),this.ws=null),this.isConnected=!1,console.log("\uD83D\uDD0C Disconnected from Twitch IRC")}constructor(){this.ws=null,this.isConnected=!1,this.config=null,this.reconnectTimeout=null,this.heartbeatInterval=null}}let i=new s;setTimeout(()=>{console.log("\uD83D\uDE80 Starting auto-connect to Twitch IRC..."),i.autoConfigureForProduction(),i.connect()},2e3)}};var e=require("../../../../webpack-runtime.js");e.C(t);var o=t=>e(e.s=t),n=e.X(0,[1638,6206,5703],()=>o(18827));module.exports=n})();