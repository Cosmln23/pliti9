"use strict";(()=>{var e={};e.id=1716,e.ids=[1716],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},73837:e=>{e.exports=require("util")},26692:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>v,patchFetch:()=>w,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>y,staticGenerationAsyncStorage:()=>l,staticGenerationBailout:()=>f});var s={};r.r(s),r.d(s,{GET:()=>u,POST:()=>c});var a=r(95419),i=r(69108),o=r(99678),n=r(78070);let p=new(r(91211)).Z("sk_test_placeholder_stripe_secret",{apiVersion:"2023-10-16"});async function c(e){try{let{sessionId:t}=await e.json();if(!t)return n.Z.json({error:"Session ID required"},{status:400});let r=await p.checkout.sessions.retrieve(t);if("paid"!==r.payment_status)return n.Z.json({error:"Payment not completed"},{status:400});{let e={email:r.customer_email,phone_number:r.metadata?.phone_number||void 0,amount:(r.amount_total||0)/100,paymentMethod:"stripe",paymentIntentId:r.payment_intent,sessionId:r.id,timestamp:new Date().toISOString()},t=await fetch("https://www.plipli9.com/api/webhooks/payment-success",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json();if(s.success)return n.Z.json({success:!0,accessCode:s.data.accessCode,expiresAt:s.data.expiresAt,message:"Payment verified and access code generated"});throw Error("Failed to process payment webhook")}}catch(e){return console.error("❌ Payment verification error:",e),n.Z.json({error:"Payment verification failed"},{status:500})}}async function u(){return n.Z.json({service:"Stripe Payment Verification",status:"active",usage:"POST with sessionId to verify payment and generate access code",flow:"Stripe → Verify → Existing payment-success webhook → Access code"})}let d=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/stripe/verify-payment/route",pathname:"/api/stripe/verify-payment",filename:"route",bundlePath:"app/api/stripe/verify-payment/route"},resolvedPagePath:"C:\\Users\\user\\Desktop\\plipli paranormal\\app\\api\\stripe\\verify-payment\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:l,serverHooks:y,headerHooks:h,staticGenerationBailout:f}=d,v="/api/stripe/verify-payment/route";function w(){return(0,o.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:l})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,6206,7257,1211],()=>r(26692));module.exports=s})();